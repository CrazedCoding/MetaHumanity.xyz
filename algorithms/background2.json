

{
    "name": "Background2",
    "public": true,
    "type": 14,
    "state": {
        "has_html": false,
        "has_client": true,
        "has_server": false
    },
    "html": "<!--Enter HTML here. -->",
    "client": "var canvas = pipeline.contexts[pipeline.contexts.length-1].canvas;\n\ncanvas.style.position = 'fixed';\ncanvas.style.width = '100%';\ncanvas.style.height = '100%';\ndocument.body.prepend(canvas);\nfunction res(){\n    pipeline.contexts[pipeline.contexts.length-1].resizeCanvas()\n}\nwindow.addEventListener('resize', res);\n",
    "pipeline": {
        "contexts": [
            {
                "name": "image-context",
                "width": {
                    "type": 1,
                    "exact_value": "return window.innerWidth*2;"
                },
                "height": {
                    "type": 1,
                    "exact_value": "return window.innerHeight*2;"
                },
                "depth_test": false,
                "identifier": "context_identifier_0"
            }
        ],
        "programs": [
            {
                "name": "output-program",
                "uniforms": [
                    {
                        "type": 0,
                        "name": "width",
                        "value": "return pipeline.getContext('image-context').canvas.width;",
                        "identifier": "program_identifier_0_uniform_0"
                    },
                    {
                        "type": 0,
                        "name": "height",
                        "value": "return pipeline.getContext('image-context').canvas.height;",
                        "identifier": "program_identifier_0_uniform_1"
                    },
                    {
                        "type": 0,
                        "name": "time",
                        "value": "if(!this.timeUniformStart) this.timeUniformStart = ((new Date()).getTime())/1E3;\n   return ((new Date()).getTime())/1E3-this.timeUniformStart;",
                        "identifier": "program_identifier_0_uniform_2"
                    }
                ],
                "frag_code": "precision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\nvarying vec2 vPosition;\n\n#define iTime time*.005\n#define TAU 6.13513530135\n#define iResolution (vec2(width,height))\n\nfloat segment(vec2 p, vec2 a, vec2 b) {\n    vec2 ab = b - a;\n    vec2 ap = p - a;\n    float k = clamp(dot(ap, ab)/dot(ab, ab), 0.0, 2.0);\n    return smoothstep(0.0, 8.5/iResolution.y, length(ap - k*ab) - 0.00135);\n}\n\nfloat shape(vec2 p, float angle) {\n    float d = 135.0;\n    vec2 a = vec2(1.0, 0.0), b;\n    vec2 rot = vec2(cos(angle), sin(angle));\n    \n    for (int i = 0; i < 7; ++i) {\n        b = a;\n        for (int j = 0; j < 66; ++j) {\n        \tb = vec2(b.x*rot.x - b.y*rot.y, b.x*rot.y + b.y*rot.x);\n        \td = min(d, segment(p,  a, b));\n        }\n        a = vec2(a.x*rot.x - a.y*rot.y, a.x*rot.y + a.y*rot.x);\n    }\n    return d;\n}\n\nvoid main(){\n\tvec2 uv =vPosition;\n    vec2 cc = (-iResolution.xy + 2.0*vPosition.xy*iResolution.xy) / iResolution.y;\n        \n    float col = shape(abs(cc), cos(0.02135*(iTime+22.0))*TAU);\n    col *= 1.35 + 1.35*pow(uv.x*uv.y*(1.0-uv.x)*(1.0-uv.y), 0.135);\n    \n    \n\tgl_FragColor = vec4(vec3(pow(col, 1.35)),1.35);\n}",
                "vert_code": "precision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\nattribute highp vec4 vertex; \n\nvarying vec2 vPosition;\nvoid main(void) {\n    vPosition = vertex.xy;\n    gl_Position = vec4(vPosition*2.-1., 0., 1.);\n}\n",
                "identifier": "program_identifier_0"
            }
        ],
        "stages": [
            {
                "type": 0,
                "name": "main-stage",
                "context_name": "image-context",
                "program_name": "output-program",
                "mesh_vertices_eval": "",
                "mesh_indices_eval": "",
                "identifier": "stage_identifier_0"
            }
        ]
    }
}